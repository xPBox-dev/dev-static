(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[500],{53266:function(k){k.exports={tabs:"tabs___YEat-"}},45572:function(k,Q,e){"use strict";var S=e(68023),V=e(99935),q=e(48579),U=e(46586),_=e(17813),lt=e(19076),Y=e(62842),M=e(68290),it=e(62604),H=e(70012);S.D([_.N,lt.N,Y.N,q.N,H.N,M.N,it.N,U.N]),Q.Z=V},19151:function(k,Q,e){"use strict";e.r(Q),e.d(Q,{default:function(){return Nt}});var S=e(33565),V=e(57361),q=e(9754),U=e.n(q),_=e(19797),lt=e(3515),Y=e(86288),M=e(96132),it=e(13254),H=e(14277),wt=e(22385),Zt=e(69713),J=e(37730),dt=e(21349),w=e(23723),c=e(67294),v=e(84787),jt=e(53266),ut=e.n(jt),h=e(21010),Et=e(84744),Ct=e(16894),It=e(7110),T=e(56905),K=e(52778),At=e(4084),t=e(85893),tt=K.Z.Statistic,St=K.Z.Divider,Pt=function(l){var r=l.loading,a=l.active,p=(0,c.useState)(!1),g=(0,S.Z)(p,2),m=g[0],Z=g[1];return(0,t.jsx)(At.Z,{onResize:function(I){Z(I.width<696)},children:(0,t.jsxs)(K.Z.Group,{loading:r,direction:m?"column":"row",style:{marginBottom:24},children:[(0,t.jsx)(K.Z,{statistic:{title:"\u5F53\u524D\u5B9E\u4F8B\u6570",value:(a==null?void 0:a.current)||0,description:(0,t.jsx)(tt,{title:"\u6628\u65E5\u5CF0\u503C",value:(a==null?void 0:a.max)||0})}}),(0,t.jsx)(St,{type:m?"horizontal":"vertical"}),(0,t.jsx)(K.Z,{statistic:{title:"24\u5C0F\u65F6\u6D3B\u8DC3\u5EA6",value:a==null?void 0:a.h24,description:(0,t.jsx)(tt,{title:"\u6628\u65E5\u540C\u6BD4",value:(a==null?void 0:a.hc)==="-"?"-":(a==null?void 0:a.hc)+"%",trend:(a==null?void 0:a.hc)<0?"down":"up"})},chartPlacement:"left"}),(0,t.jsx)(K.Z,{statistic:{title:"\u672C\u6708\u6D3B\u8DC3\u5EA6",value:a==null?void 0:a.month,description:(0,t.jsx)(tt,{title:"\u4E0A\u6708\u540C\u6BD4",value:(a==null?void 0:a.mc)==="-"?"-":(a==null?void 0:a.mc)+"%",trend:(a==null?void 0:a.mc)<0?"down":"up"})},chartPlacement:"left"})]})},"resize-observer")},ct=Pt,vt=e(13718);function ht(i){for(var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2,r=i.indexOf("/"),a=0;a<l&&r!==-1;a++)r=i.indexOf("/",r+1);return r!==-1?i.substr(0,r):i}var Dt=function(l){var r,a,p,g,m,Z,C,I=l.showAll,B=l.userId,F=c.useState("hour"),A=(0,S.Z)(F,2),j=A[0],R=A[1];c.useEffect(function(){n.run(),j==="hour"?x.reset():x.run()},[B]);var n=(0,h.QT)(function(){return I?(0,T.Pf)({hour:!0,base:!0,userId:B}):(0,T.s8)({hour:!0,base:!0})},{manual:!0}),x=(0,h.QT)(function(){return I?(0,T.Pf)({month:!0,userId:B}):(0,T.s8)({month:!0})},{manual:!0}),N=[{title:"\u5E94\u7528\u540D",dataIndex:"appName",key:"appName",render:function(E,y){return(0,t.jsx)(Zt.Z,{placement:"top",title:y.appId,children:(0,t.jsx)("a",{onClick:function(){return h.m8.push(ht(h.m8.location.pathname)+"/"+y.id)},children:E})})}}].concat((0,J.Z)(I?[{title:"\u7528\u6237",dataIndex:"userId",key:"userId",copyable:!0,render:function(E,y){return(0,t.jsxs)(t.Fragment,{children:[y.nick," (",y.email,")"]})}}]:[]),[{title:"\u6D3B\u8DC3\u5EA6",dataIndex:"active",key:"active",hideInSearch:!0},{title:"\u5E73\u5747\u6D3B\u8DC3\u8BBE\u5907",dataIndex:"device",key:"device",hideInSearch:!0},{title:"\u542F\u52A8\u6B21\u6570",dataIndex:"count",key:"count",hideInSearch:!0}]),W={appendPadding:10,height:400,data:j==="hour"?((r=n.data)===null||r===void 0?void 0:r.hour.rank)||[]:((a=x.data)===null||a===void 0?void 0:a.month.rank)||[],angleField:"value",colorField:"type",radius:.8,loading:j==="hour"?n.loading:x.loading,label:{type:"outer",content:"{name} {percentage}"},onReady:function(E){E.on("element:click",function(y){h.m8.push(ht(h.m8.location.pathname)+"/"+y.data.data.id)})},interactions:[{type:"pie-legend-active"},{type:"element-active"}]},d=(0,t.jsxs)(v.ZP,{split:"horizontal",children:[(0,t.jsx)(v.ZP,{bodyStyle:{padding:0},style:{marginTop:10},children:(0,t.jsx)(Ct.ZP,{headerTitle:"\u6D3B\u8DC3\u5E94\u7528\u5217\u8868",dataSource:j==="hour"?((p=n.data)===null||p===void 0?void 0:p.hour.list)||[]:((g=x.data)===null||g===void 0?void 0:g.month.list)||[],loading:j==="hour"?n.loading:x.loading,rowKey:"id",search:!1,scroll:{x:600},options:{fullScreen:!0,reload:!0,setting:!0},columns:N})}),(0,t.jsx)(v.ZP,{title:"TOP10\u6D3B\u8DC3\u5E94\u7528",collapsible:!0,style:{position:"relative"},bodyStyle:{height:"auto"},children:(j==="hour"?(((m=n.data)===null||m===void 0?void 0:m.hour.rank)||[]).length===0:(((Z=x.data)===null||Z===void 0?void 0:Z.month.rank)||[]).length===0)?(0,t.jsx)(H.Z,{image:H.Z.PRESENTED_IMAGE_SIMPLE}):(0,t.jsx)(It.Z,(0,M.Z)({},W))})]});return(0,t.jsx)(dt.Z,{children:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.Suspense,{fallback:(0,t.jsx)(w.Z,{}),children:(0,t.jsx)(ct,{loading:n.loading,active:(C=n.data)===null||C===void 0?void 0:C.base})}),(0,t.jsxs)(c.Suspense,{fallback:(0,t.jsx)(w.Z,{}),children:[(0,t.jsx)(Y.Z,{offsetTop:vt.M,style:{overflow:"hidden"},children:(0,t.jsxs)(v.ZP,{className:ut().tabs,tabs:{tabPosition:"top",size:"large",activeKey:j,onChange:function(E){R(E),E==="month"&&!x.data&&!x.loading&&x.run()}},style:{boxShadow:"0 0 5px #00000044"},children:[(0,t.jsx)(v.ZP.TabPane,{tab:"24\u5C0F\u65F6\u62A5",cardProps:{bodyStyle:{padding:0}}},"hour"),(0,t.jsx)(v.ZP.TabPane,{tab:"\u6708\u62A5",cardProps:{bodyStyle:{padding:0}}},"month")]})}),(0,t.jsx)(v.ZP,{bodyStyle:{padding:0},children:d})]})]})})},bt=Dt,kt=e(14965),Bt=e(14072),qt=e(64896),Ot=e(37744),_t=e(57663),et=e(71577),te=e(58024),ft=e(39144),ee=e(20228),at=e(11382),pt=e(65476),Tt=e(46360),Ft=e.n(Tt),$t=e(97221),nt=e(57845),mt=e(45572),xt=e(87155),Mt=e(30381),o=e.n(Mt);function yt(i){for(var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2,r=i.indexOf("/"),a=0;a<l&&r!==-1;a++)r=i.indexOf("/",r+1);return r!==-1?i.substr(0,r):i}var Rt=function(l){var r,a,p,g,m,Z,C,I,B,F,A,j=l.showAll,R=l.userId,n=l.appId,x=l.setAppId,N=c.useState("current"),W=(0,S.Z)(N,2),d=W[0],$=W[1],E=c.useState(n===""?[]:[{value:n,label:(0,t.jsx)(at.Z,{size:"small"}),disabled:!0}]),y=(0,S.Z)(E,2),X=y[0],Wt=y[1],O=c.useRef({instance:!0,device:!1,count:!1}),zt=c.useState({start:0,end:0}),gt=(0,S.Z)(zt,2),f=gt[0],Gt=gt[1];function Xt(u){return rt.apply(this,arguments)}function rt(){return rt=(0,V.Z)(U().mark(function u(s){return U().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.abrupt("return",(0,Et.yC)((0,M.Z)((0,M.Z)({search:s},j?{all:j}:{}),R!==0?{userId:R}:{})));case 1:case"end":return b.stop()}},u)})),rt.apply(this,arguments)}var z=(0,h.QT)(function(){return(0,T.CF)({current:!0,base:!0,appId:n})},{manual:n===""}),P=(0,h.QT)(function(){return(0,T.Xf)({appId:n,stat:"instance",type:d,start:f.start,end:f.end})},{manual:n===""}),D=(0,h.QT)(function(){return(0,T.Xf)({appId:n,stat:"device",type:d,start:f.start,end:f.end})},{manual:!0}),L=(0,h.QT)(function(){return(0,T.Xf)({appId:n,stat:"count",type:d,start:f.start,end:f.end})},{manual:!0}),ot=function(s){O.current.instance?P.run():P.reset(),O.current.device?D.run():D.reset(),O.current.count?L.run():L.reset(),s&&z.run()},Qt=function(s){var G=f.start!==0&&s.format("X")/86400-f.start/24>365,b=f.end!==0&&f.end/24-s.format("X")/86400>365;return s&&s>o()().endOf("day")||b||G};(0,nt.e)(function(){ot(!0)},[n]),(0,nt.e)(function(){ot(!1)},[d]),(0,nt.e)(function(){!(d==="custom"&&(f.start===0||f.end===0))&&ot(!1)},[f]),(0,c.useEffect)(function(){var u,s;Wt([{value:(u=z.data)===null||u===void 0?void 0:u.id,label:(s=z.data)===null||s===void 0?void 0:s.title}])},[z.data]);var Vt=(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(pt.Z,(0,M.Z)((0,M.Z)({showSearch:!0},n===""?{}:{value:n}),{},{placeholder:"\u9009\u62E9\u5E94\u7528",fetchOptions:Xt,setMyOption:X,style:{minWidth:"200px",maxWidth:"350px"},onChange:function(s){x(s),h.m8.push(yt(h.m8.location.pathname)+"/"+s)}}))}),Yt={tooltip:{trigger:"axis"},legend:{data:["\u6D3B\u8DC3\u8BBE\u5907\u6570","\u5E73\u5747\u6D3B\u8DC3\u65F6\u95F4"].concat((0,J.Z)(d==="current"?["\u7D2F\u8BA1\u6D3B\u8DC3\u8BBE\u5907"]:[]))},grid:{top:"30px",left:"10px",right:"10px",bottom:"50px",containLabel:!0},xAxis:[{type:"category",boundaryGap:!1,data:(r=D.data)===null||r===void 0?void 0:r.x}],yAxis:[{name:"\u8BBE\u5907\u6570",type:"value",minInterval:1},{name:"\u6D3B\u8DC3\u65F6\u95F4(\u79D2)",type:"value",max:3600}],dataZoom:[{show:!0,xAxisIndex:0,start:d==="current"?66.666:0}],series:[].concat((0,J.Z)(d==="current"?[{name:"\u7D2F\u8BA1\u6D3B\u8DC3\u8BBE\u5907",type:"custom",stack:"\u7D2F\u8BA1\u6D3B\u8DC3\u8BBE\u5907",renderItem:function(){},data:[(a=D.data)===null||a===void 0?void 0:a.total],encode:{x:0,y:0,tooltip:0},markLine:{data:[{type:"max",name:"\u672C\u65E5\u7D2F\u8BA1\u6D3B\u8DC3\u5B9E\u4F8B",label:{position:"insideStartTop",formatter:"\u672C\u65E5\u7D2F\u8BA1\u6D3B\u8DC3\u5B9E\u4F8B"},tooltip:{trigger:"item"},yAxis:(p=D.data)===null||p===void 0?void 0:p.total}]}}]:[]),[{name:"\u6D3B\u8DC3\u8BBE\u5907\u6570",type:"line",smooth:!0,stack:"\u8BBE\u5907\u6570",color:"#D23325",data:(g=D.data)===null||g===void 0?void 0:g.instance},{name:"\u5E73\u5747\u6D3B\u8DC3\u65F6\u95F4",type:"line",yAxisIndex:1,smooth:!0,color:"#5888F3",areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"#1890ff"},{offset:.5,color:"#7ec2f3"},{offset:1,color:"#ffffff"}],global:!1}},stack:"\u65F6\u95F4",data:(m=D.data)===null||m===void 0?void 0:m.time}])},Ht={tooltip:{trigger:"axis"},legend:{data:["\u6D3B\u8DC3\u5B9E\u4F8B\u6570","\u5E73\u5747\u6D3B\u8DC3\u65F6\u95F4","\u7D2F\u8BA1\u6D3B\u8DC3\u5B9E\u4F8B"]},grid:{top:"30px",left:"10px",right:"10px",bottom:"50px",containLabel:!0},xAxis:[{type:"category",boundaryGap:!1,data:(Z=P.data)===null||Z===void 0?void 0:Z.x}],yAxis:[{name:"\u5B9E\u4F8B\u6570",type:"value",minInterval:1},{name:"\u6D3B\u8DC3\u65F6\u95F4(\u79D2)",type:"value",max:3600}],dataZoom:[{show:!0,xAxisIndex:0,start:d==="current"?66.666:0}],series:[].concat((0,J.Z)(d==="current"?[{name:"\u7D2F\u8BA1\u6D3B\u8DC3\u5B9E\u4F8B",type:"custom",stack:"\u7D2F\u8BA1\u6D3B\u8DC3\u5B9E\u4F8B",renderItem:function(){},data:[(C=P.data)===null||C===void 0?void 0:C.total],encode:{x:0,y:0,tooltip:0},markLine:{data:[{type:"max",name:"\u672C\u65E5\u7D2F\u8BA1\u6D3B\u8DC3\u5B9E\u4F8B",label:{position:"insideStartTop",formatter:"\u672C\u65E5\u7D2F\u8BA1\u6D3B\u8DC3\u5B9E\u4F8B"},tooltip:{trigger:"item"},yAxis:(I=P.data)===null||I===void 0?void 0:I.total}]}}]:[]),[{name:"\u6D3B\u8DC3\u5B9E\u4F8B\u6570",type:"line",smooth:!0,stack:"\u5B9E\u4F8B\u6570",color:"#D23325",data:(B=P.data)===null||B===void 0?void 0:B.instance},{name:"\u5E73\u5747\u6D3B\u8DC3\u65F6\u95F4",type:"line",yAxisIndex:1,smooth:!0,color:"#5888F3",areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"#1890ff"},{offset:.5,color:"#7ec2f3"},{offset:1,color:"#ffffff"}],global:!1}},stack:"\u65F6\u95F4",data:(F=P.data)===null||F===void 0?void 0:F.time}])},Jt=d==="custom"&&(f.start===0||f.end===0)?(0,t.jsx)(ft.Z,{bordered:!1,children:"\u8BF7\u9009\u62E9\u4E00\u4E2A\u65F6\u95F4\u6BB5"}):(0,t.jsxs)(v.ZP,{split:"horizontal",children:[(0,t.jsx)(v.ZP,{collapsible:!0,defaultCollapsed:!O.current.instance,title:"\u6D3B\u8DC3\u5B9E\u4F8B\u8D8B\u52BF",style:{position:"relative"},onCollapse:function(s){O.current.instance=!s,!P.data&&P.run()},children:(0,t.jsx)(at.Z,{spinning:P.loading,children:(0,t.jsx)(xt.Z,{notMerge:!0,echarts:mt.Z,option:Ht,style:{height:300}})})}),(0,t.jsx)(v.ZP,{collapsible:!0,defaultCollapsed:!O.current.device,title:"\u6D3B\u8DC3\u8BBE\u5907\u8D8B\u52BF",style:{position:"relative"},onCollapse:function(s){O.current.device=!s,!D.data&&D.run()},children:(0,t.jsx)(at.Z,{spinning:D.loading,children:(0,t.jsx)(xt.Z,{notMerge:!0,echarts:mt.Z,option:Yt,style:{height:300}})})}),(0,t.jsx)(v.ZP,{collapsible:!0,defaultCollapsed:!O.current.count,title:"\u542F\u52A8\u6B21\u6570\u8D8B\u52BF",style:{position:"relative"},bodyStyle:{height:"auto"},onCollapse:function(s){O.current.count=!s,!L.data&&L.run()},children:(0,t.jsx)($t.Z,{loading:L.loading||!L.data,height:300,data:L.data||[],xField:"x",yField:"y",xAxis:{visible:!0},yAxis:{visible:!0,title:{visible:!1}},slider:{start:d==="current"?.6666:0,end:1},title:{visible:!0,text:"\u542F\u52A8\u6B21\u6570\u8D8B\u52BF",style:{fontSize:14}},meta:{y:{alias:"\u542F\u52A8\u6B21\u6570"}}})})]});return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Ot.Z,{className:Ft().header,title:Vt,subTitle:"\u7684\u7EDF\u8BA1\u4FE1\u606F",extra:n&&(0,t.jsxs)(et.Z.Group,{children:[(0,t.jsx)(et.Z,{onClick:function(){h.m8.push(yt(h.m8.location.pathname,1)+"/install/"+n)},children:"\u5B89\u88C5\u7EDF\u8BA1"}),(0,t.jsx)(et.Z,{onClick:function(){h.m8.push("/app/detail/"+n)},children:"\u5E94\u7528\u8BE6\u60C5"})]}),style:{padding:0,marginBottom:20}}),n?(0,t.jsx)(dt.Z,{children:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.Suspense,{fallback:(0,t.jsx)(w.Z,{}),children:(0,t.jsx)(ct,{loading:z.loading,active:(A=z.data)===null||A===void 0?void 0:A.base})}),(0,t.jsxs)(c.Suspense,{fallback:(0,t.jsx)(w.Z,{}),children:[(0,t.jsx)(Y.Z,{offsetTop:vt.M,style:{overflow:"hidden"},children:(0,t.jsxs)(v.ZP,{className:ut().tabs,tabs:{tabPosition:"top",size:"middle",activeKey:d,onChange:function(s){$(s)}},style:{boxShadow:"0 0 5px #00000044"},children:[(0,t.jsx)(v.ZP.TabPane,{tab:"\u8FD124\u5C0F\u65F6",cardProps:{bodyStyle:{padding:0}}},"current"),(0,t.jsx)(v.ZP.TabPane,{tab:"\u8FD1\u4E00\u4E2A\u6708",cardProps:{bodyStyle:{padding:0}}},"month"),(0,t.jsx)(v.ZP.TabPane,{tab:(0,t.jsxs)(t.Fragment,{children:["\u81EA\u5B9A\u4E49:",(0,t.jsx)(Bt.Z.RangePicker,{bordered:!1,disabledDate:Qt,ranges:{\u4ECA\u65E5:[o()(),o()()],\u672C\u5468:[o()().startOf("week"),o()()],\u672C\u6708:[o()().startOf("month"),o()()],\u8FC7\u53BB7\u5929:[o()().subtract(7,"day"),o()()],\u8FC7\u53BB30\u5929:[o()().subtract(30,"day"),o()()],\u8FC7\u53BB60\u5929:[o()().subtract(60,"day"),o()()],\u8FC7\u53BB90\u5929:[o()().subtract(90,"day"),o()()],\u8FC7\u53BB120\u5929:[o()().subtract(120,"day"),o()()],\u8FC7\u53BB180\u5929:[o()().subtract(180,"day"),o()()],\u8FC7\u53BB360\u5929:[o()().subtract(360,"day"),o()()]},onCalendarChange:function(s){var G,b;return Gt(s?{start:parseInt(((G=s[0])===null||G===void 0?void 0:G.startOf("day").format("X"))/3600)|0,end:parseInt(((b=s[1])===null||b===void 0?void 0:b.startOf("day").format("X"))/3600)|0}:{start:0,end:0})}})]}),cardProps:{bodyStyle:{padding:0}}},"custom")]})}),(0,t.jsx)(v.ZP,{bodyStyle:{padding:0},children:Jt})]})]})}):(0,t.jsx)(ft.Z,{bodyStyle:{textAlign:"center"},children:"\u8BF7\u5148\u9009\u62E9\u4E00\u4E2A\u5E94\u7528"})]})},Lt=Rt,Ut=e(6637);function Kt(i){return st.apply(this,arguments)}function st(){return st=(0,V.Z)(U().mark(function i(l){return U().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,Ut.y)({search:l}));case 1:case"end":return a.stop()}},i)})),st.apply(this,arguments)}var Nt=function(i){var l=i.route.name==="all-instance",r=c.useState(i.match.params.appId?i.match.params.appId:""),a=(0,S.Z)(r,2),p=a[0],g=a[1],m=c.useRef(p?"detail":"overview"),Z=(0,h.tT)("admin"),C=Z.selectedUser,I=Z.setData,B=(0,c.useState)(C.value),F=(0,S.Z)(B,2),A=F[0],j=F[1],R=(0,t.jsx)(bt,{showAll:l,userId:A}),n=(0,t.jsx)(Lt,{showAll:l,userId:A,appId:p,setAppId:g}),x=c.useState(p?n:R),N=(0,S.Z)(x,2),W=N[0],d=N[1];(0,c.useEffect)(function(){$()},[A,p]);var $=function(){m.current==="overview"?d(R):d(n)};return(0,t.jsx)(_.ZP,{tabList:[{tab:"\u6982\u89C8",key:"overview"},{tab:"\u8BE6\u7EC6\u8D8B\u52BF",key:"detail"}],tabActiveKey:m.current,content:l&&(0,t.jsxs)(t.Fragment,{children:["\u5F00\u53D1\u8005\uFF1A",(0,t.jsx)(pt.Z,{showAll:!0,showSearch:!0,placeholder:"\u9009\u62E9\u7528\u6237",setMyOption:[C],fetchOptions:Kt,defaultValue:A,style:{width:"250px"},onChange:function(y,X){j(y),I({label:X.label,value:X.value})}})]}),onTabChange:function(y){m.current=y,$()},children:W})}}}]);
