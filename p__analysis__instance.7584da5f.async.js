(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[1500],{78311:function($,v,e){"use strict";e.r(v);var C=e(3515),A=e(85461),U=e(13254),i=e(14277),c=e(96132),W=e(22385),h=e(69713),f=e(37730),p=e(33565),I=e(21349),u=e(23723),o=e(67294),_=e(84787),y=e(53266),j=e.n(y),a=e(73727),s=e(21010),l=e(16894),r=e(7110),E=e(56905),b=e(27368),R=e(13718),n=e(85893);function L(P){for(var O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2,t=P.indexOf("/"),d=0;d<O&&t!==-1;d++)t=P.indexOf("/",t+1);return t!==-1?P.substr(0,t):P}var K=function(O){var t,d,Z,S,V,x=O.showAll,B=O.userId,G=o.useState("hour"),N=(0,p.Z)(G,2),g=N[0],z=N[1];o.useEffect(function(){T.run(),g==="hour"?m.reset():m.run()},[B]);var T=(0,s.QT)(function(){return x?(0,E.Pf)({hour:!0,base:!0,userId:B}):(0,E.s8)({hour:!0,base:!0})},{manual:!0}),m=(0,s.QT)(function(){return x?(0,E.Pf)({month:!0,userId:B}):(0,E.s8)({month:!0})},{manual:!0}),Q=[{title:"\u5E94\u7528\u540D",dataIndex:"appName",key:"appName",render:function(D,M){return(0,n.jsx)(h.Z,{placement:"top",title:M.appId,children:(0,n.jsx)(a.rU,{to:L(s.m8.location.pathname)+"/"+M.id,children:D})})}}].concat((0,f.Z)(x?[{title:"\u7528\u6237",dataIndex:"userId",key:"userId",copyable:!0,render:function(D,M){return(0,n.jsxs)(n.Fragment,{children:[M.nick," (",M.email,")"]})}}]:[]),[{title:"\u6D3B\u8DC3\u5EA6",dataIndex:"active",key:"active",hideInSearch:!0},{title:"\u5E73\u5747\u6D3B\u8DC3\u8BBE\u5907",dataIndex:"device",key:"device",hideInSearch:!0},{title:"\u542F\u52A8\u6B21\u6570",dataIndex:"count",key:"count",hideInSearch:!0}]),X={appendPadding:10,height:400,data:g==="hour"?((t=T.data)===null||t===void 0?void 0:t.hour.rank)||[]:((d=m.data)===null||d===void 0?void 0:d.month.rank)||[],angleField:"value",colorField:"type",radius:.8,loading:g==="hour"?T.loading:m.loading,label:{type:"outer",content:"{name} {percentage}"},onReady:function(D){D.on("element:click",function(M){s.m8.push(L(s.m8.location.pathname)+"/"+M.data.data.id)})},interactions:[{type:"pie-legend-active"},{type:"element-active"}]},Y=(0,n.jsxs)(_.ZP,{split:"horizontal",children:[(0,n.jsx)(_.ZP,{bodyStyle:{padding:0},style:{marginTop:10},children:(0,n.jsx)(l.ZP,{headerTitle:"\u6D3B\u8DC3\u5E94\u7528\u5217\u8868",params:(0,c.Z)((0,c.Z)({},g==="hour"?{type:1}:{type:2}),x?{userId:B}:{}),rowKey:"id",search:!1,request:x?E.Up:E.IX,scroll:{x:600},options:{fullScreen:!0,reload:!0,setting:!0},columns:Q})}),(0,n.jsx)(_.ZP,{title:"TOP10\u6D3B\u8DC3\u5E94\u7528",collapsible:!0,style:{position:"relative"},bodyStyle:{height:"auto"},children:(g==="hour"?(((Z=T.data)===null||Z===void 0?void 0:Z.hour.rank)||[]).length===0:(((S=m.data)===null||S===void 0?void 0:S.month.rank)||[]).length===0)?(0,n.jsx)(i.Z,{image:i.Z.PRESENTED_IMAGE_SIMPLE}):(0,n.jsx)(r.Z,(0,c.Z)({},X))})]});return(0,n.jsx)(I.Z,{children:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.Suspense,{fallback:(0,n.jsx)(u.Z,{}),children:(0,n.jsx)(b.Z,{loading:T.loading,active:(V=T.data)===null||V===void 0?void 0:V.base})}),(0,n.jsxs)(o.Suspense,{fallback:(0,n.jsx)(u.Z,{}),children:[(0,n.jsx)(A.Z,{offsetTop:R.M,style:{overflow:"hidden"},children:(0,n.jsxs)(_.ZP,{className:j().tabs,tabs:{tabPosition:"top",size:"large",activeKey:g,onChange:function(D){z(D),D==="month"&&!m.data&&!m.loading&&m.run()}},style:{boxShadow:"0 0 5px #00000044"},children:[(0,n.jsx)(_.ZP.TabPane,{tab:"24\u5C0F\u65F6\u62A5",cardProps:{bodyStyle:{padding:0}}},"hour"),(0,n.jsx)(_.ZP.TabPane,{tab:"\u6708\u62A5",cardProps:{bodyStyle:{padding:0}}},"month")]})}),(0,n.jsx)(_.ZP,{bodyStyle:{padding:0},children:Y})]})]})})};v.default=K},26751:function($,v,e){"use strict";e.r(v);var C=e(33565),A=e(57361),U=e(9754),i=e.n(U),c=e(19797),W=e(78311),h=e(67294),f=e(49466),p=e(65476),I=e(6637),u=e(21010),o=e(85893);function _(a){return y.apply(this,arguments)}function y(){return y=(0,A.Z)(i().mark(function a(s){return i().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,I.y)({search:s}));case 1:case"end":return r.stop()}},a)})),y.apply(this,arguments)}function j(a){for(var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2,l=a.indexOf("/"),r=0;r<s&&l!==-1;r++)l=a.indexOf("/",l+1);return l!==-1?a.substr(0,l):a}v.default=function(a){var s=a.route.name==="all-instance",l=(0,u.tT)("admin"),r=l.selectedUser,E=l.setData,b=(0,h.useState)(r.value),R=(0,C.Z)(b,2),n=R[0],L=R[1],K=h.useRef(""),P=function(t){K.current=t};return(0,o.jsx)(c.ZP,{tabList:[{tab:"\u6982\u89C8",key:"overview"},{tab:"\u8BE6\u7EC6\u8D8B\u52BF",key:"detail"}],tabActiveKey:a.location.pathname.substr(-8)==="instance"?"overview":"detail",content:s&&(0,o.jsxs)(o.Fragment,{children:["\u5F00\u53D1\u8005\uFF1A",(0,o.jsx)(p.Z,{showAll:!0,showSearch:!0,placeholder:"\u9009\u62E9\u7528\u6237",setMyOption:[r],fetchOptions:_,defaultValue:n,style:{width:"250px"},onChange:function(t,d){L(t),E({label:d.label,value:d.value})}})]}),onTabChange:function(t){t==="overview"?u.m8.push(j(u.m8.location.pathname)):u.m8.push(j(u.m8.location.pathname)+"/"+K.current)},children:h.cloneElement(a.children,{showAll:s,userId:n,setAppId:P})})}},6637:function($,v,e){"use strict";e.d(v,{y:function(){return h}});var C=e(96132),A=e(57361),U=e(9754),i=e.n(U),c=e(18811),W=e(21010);function h(p,I){return f.apply(this,arguments)}function f(){return f=(0,A.Z)(i().mark(function p(I,u){return i().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.abrupt("return",(0,W.WY)(c.s3+"user/search",{method:"POST",params:(0,C.Z)({},I),credentials:"include"}));case 1:case"end":return _.stop()}},p)})),f.apply(this,arguments)}}}]);
