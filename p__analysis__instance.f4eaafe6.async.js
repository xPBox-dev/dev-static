(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[500],{53266:function(k){k.exports={tabs:"tabs___YEat-"}},45572:function(k,Q,e){"use strict";var A=e(68023),V=e(99935),q=e(48579),U=e(46586),_=e(17813),lt=e(19076),Y=e(62842),$=e(68290),it=e(62604),H=e(70012);A.D([_.N,lt.N,Y.N,q.N,H.N,$.N,it.N,U.N]),Q.Z=V},19151:function(k,Q,e){"use strict";e.r(Q),e.d(Q,{default:function(){return Kt}});var A=e(33565),V=e(57361),q=e(9754),U=e.n(q),_=e(19797),lt=e(3515),Y=e(86288),$=e(96132),it=e(13254),H=e(14277),Jt=e(22385),yt=e(69713),J=e(37730),dt=e(21349),w=e(23723),c=e(67294),v=e(84787),gt=e(53266),ut=e.n(gt),f=e(21010),Zt=e(84744),jt=e(93660),Et=e(7110),T=e(56905),K=e(52778),Ct=e(4084),t=e(85893),tt=K.Z.Statistic,It=K.Z.Divider,At=function(l){var r=l.loading,a=l.active,p=(0,c.useState)(!1),y=(0,A.Z)(p,2),m=y[0],g=y[1];return(0,t.jsx)(Ct.Z,{onResize:function(C){g(C.width<696)},children:(0,t.jsxs)(K.Z.Group,{loading:r,direction:m?"column":"row",style:{marginBottom:24},children:[(0,t.jsx)(K.Z,{statistic:{title:"\u5F53\u524D\u5B9E\u4F8B\u6570",value:(a==null?void 0:a.current)||0,description:(0,t.jsx)(tt,{title:"\u6628\u65E5\u5CF0\u503C",value:(a==null?void 0:a.max)||0})}}),(0,t.jsx)(It,{type:m?"horizontal":"vertical"}),(0,t.jsx)(K.Z,{statistic:{title:"24\u5C0F\u65F6\u6D3B\u8DC3\u5EA6",value:a==null?void 0:a.h24,description:(0,t.jsx)(tt,{title:"\u6628\u65E5\u540C\u6BD4",value:(a==null?void 0:a.hc)==="-"?"-":(a==null?void 0:a.hc)+"%",trend:(a==null?void 0:a.hc)<0?"down":"up"})},chartPlacement:"left"}),(0,t.jsx)(K.Z,{statistic:{title:"\u672C\u6708\u6D3B\u8DC3\u5EA6",value:a==null?void 0:a.month,description:(0,t.jsx)(tt,{title:"\u4E0A\u6708\u540C\u6BD4",value:(a==null?void 0:a.mc)==="-"?"-":(a==null?void 0:a.mc)+"%",trend:(a==null?void 0:a.mc)<0?"down":"up"})},chartPlacement:"left"})]})},"resize-observer")},ct=At;function St(i){for(var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2,r=i.indexOf("/"),a=0;a<l&&r!==-1;a++)r=i.indexOf("/",r+1);return r!==-1?i.substr(0,r):i}var Pt=function(l){var r,a,p,y,m,g,E,C=l.showAll,B=l.userId,F=c.useState("hour"),I=(0,A.Z)(F,2),Z=I[0],M=I[1];c.useEffect(function(){n.run(),Z==="hour"?x.reset():x.run()},[B]);var n=(0,f.QT)(function(){return C?(0,T.Pf)({hour:!0,base:!0,userId:B}):(0,T.s8)({hour:!0,base:!0})},{manual:!0}),x=(0,f.QT)(function(){return C?(0,T.Pf)({month:!0,userId:B}):(0,T.s8)({month:!0})},{manual:!0}),N=[{title:"\u5E94\u7528\u540D",dataIndex:"appName",key:"appName",render:function(S,j){return(0,t.jsx)(yt.Z,{placement:"top",title:j.appId,children:(0,t.jsx)("a",{onClick:function(){return f.m8.push(St(f.m8.location.pathname)+"/"+j.id)},children:S})})}}].concat((0,J.Z)(C?[{title:"\u7528\u6237",dataIndex:"userId",key:"userId",copyable:!0,render:function(S,j){return(0,t.jsxs)(t.Fragment,{children:[j.nick," (",j.email,")"]})}}]:[]),[{title:"\u6D3B\u8DC3\u5EA6",dataIndex:"active",key:"active",hideInSearch:!0},{title:"\u5E73\u5747\u6D3B\u8DC3\u8BBE\u5907",dataIndex:"device",key:"device",hideInSearch:!0},{title:"\u542F\u52A8\u6B21\u6570",dataIndex:"count",key:"count",hideInSearch:!0}]),W={appendPadding:10,height:400,data:Z==="hour"?((r=n.data)===null||r===void 0?void 0:r.hour.rank)||[]:((a=x.data)===null||a===void 0?void 0:a.month.rank)||[],angleField:"value",colorField:"type",radius:.8,loading:Z==="hour"?n.loading:x.loading,label:{type:"outer",content:"{name} {percentage}"},interactions:[{type:"pie-legend-active"},{type:"element-active"}]},d=(0,t.jsxs)(v.ZP,{split:"horizontal",children:[(0,t.jsx)(v.ZP,{bodyStyle:{padding:0},style:{marginTop:10},children:(0,t.jsx)(jt.ZP,{headerTitle:"\u6D3B\u8DC3\u5E94\u7528\u5217\u8868",dataSource:Z==="hour"?((p=n.data)===null||p===void 0?void 0:p.hour.list)||[]:((y=x.data)===null||y===void 0?void 0:y.month.list)||[],loading:Z==="hour"?n.loading:x.loading,rowKey:"id",search:!1,scroll:{x:600},options:{fullScreen:!0,reload:!0,setting:!0},columns:N})}),(0,t.jsx)(v.ZP,{title:"TOP10\u6D3B\u8DC3\u5E94\u7528",collapsible:!0,style:{position:"relative"},bodyStyle:{height:"auto"},children:(Z==="hour"?(((m=n.data)===null||m===void 0?void 0:m.hour.rank)||[]).length===0:(((g=x.data)===null||g===void 0?void 0:g.month.rank)||[]).length===0)?(0,t.jsx)(H.Z,{image:H.Z.PRESENTED_IMAGE_SIMPLE}):(0,t.jsx)(Et.Z,(0,$.Z)({},W))})]});return(0,t.jsx)(dt.Z,{children:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.Suspense,{fallback:(0,t.jsx)(w.Z,{}),children:(0,t.jsx)(ct,{loading:n.loading,active:(E=n.data)===null||E===void 0?void 0:E.base})}),(0,t.jsxs)(c.Suspense,{fallback:(0,t.jsx)(w.Z,{}),children:[(0,t.jsx)(Y.Z,{offsetTop:47,style:{overflow:"hidden"},children:(0,t.jsxs)(v.ZP,{className:ut().tabs,tabs:{tabPosition:"top",size:"large",activeKey:Z,onChange:function(S){M(S),S==="month"&&!x.data&&!x.loading&&x.run()}},style:{boxShadow:"0 0 5px #00000044"},children:[(0,t.jsx)(v.ZP.TabPane,{tab:"24\u5C0F\u65F6\u62A5",cardProps:{bodyStyle:{padding:0}}},"hour"),(0,t.jsx)(v.ZP.TabPane,{tab:"\u6708\u62A5",cardProps:{bodyStyle:{padding:0}}},"month")]})}),(0,t.jsx)(v.ZP,{bodyStyle:{padding:0},children:d})]})]})})},Dt=Pt,wt=e(14965),bt=e(14072),kt=e(64896),Bt=e(37744),qt=e(57663),et=e(71577),_t=e(58024),vt=e(39144),te=e(20228),at=e(11382),ht=e(65476),Ot=e(46360),Tt=e.n(Ot),Ft=e(97221),nt=e(57845),ft=e(45572),pt=e(87155),$t=e(30381),o=e.n($t);function mt(i){for(var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2,r=i.indexOf("/"),a=0;a<l&&r!==-1;a++)r=i.indexOf("/",r+1);return r!==-1?i.substr(0,r):i}var Mt=function(l){var r,a,p,y,m,g,E,C,B,F,I,Z=l.showAll,M=l.userId,n=l.appId,x=l.setAppId,N=c.useState("current"),W=(0,A.Z)(N,2),d=W[0],R=W[1],S=c.useState(n===""?[]:[{value:n,label:(0,t.jsx)(at.Z,{size:"small"}),disabled:!0}]),j=(0,A.Z)(S,2),X=j[0],Nt=j[1],O=c.useRef({instance:!0,device:!1,count:!1}),Wt=c.useState({start:0,end:0}),xt=(0,A.Z)(Wt,2),h=xt[0],zt=xt[1];function Gt(u){return rt.apply(this,arguments)}function rt(){return rt=(0,V.Z)(U().mark(function u(s){return U().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.abrupt("return",(0,Zt.yC)((0,$.Z)((0,$.Z)({search:s},Z?{all:Z}:{}),M!==0?{userId:M}:{})));case 1:case"end":return b.stop()}},u)})),rt.apply(this,arguments)}var z=(0,f.QT)(function(){return(0,T.CF)({current:!0,base:!0,appId:n})},{manual:n===""}),P=(0,f.QT)(function(){return(0,T.Xf)({appId:n,stat:"instance",type:d,start:h.start,end:h.end})},{manual:n===""}),D=(0,f.QT)(function(){return(0,T.Xf)({appId:n,stat:"device",type:d,start:h.start,end:h.end})},{manual:!0}),L=(0,f.QT)(function(){return(0,T.Xf)({appId:n,stat:"count",type:d,start:h.start,end:h.end})},{manual:!0}),ot=function(s){O.current.instance?P.run():P.reset(),O.current.device?D.run():D.reset(),O.current.count?L.run():L.reset(),s&&z.run()},Xt=function(s){var G=h.start!==0&&s.format("X")/86400-h.start/24>365,b=h.end!==0&&h.end/24-s.format("X")/86400>365;return s&&s>o()().endOf("day")||b||G};(0,nt.e)(function(){ot(!0)},[n]),(0,nt.e)(function(){ot(!1)},[d]),(0,nt.e)(function(){!(d==="custom"&&(h.start===0||h.end===0))&&ot(!1)},[h]),(0,c.useEffect)(function(){var u,s;Nt([{value:(u=z.data)===null||u===void 0?void 0:u.id,label:(s=z.data)===null||s===void 0?void 0:s.title}])},[z.data]);var Qt=(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(ht.Z,(0,$.Z)((0,$.Z)({showSearch:!0},n===""?{}:{value:n}),{},{placeholder:"\u9009\u62E9\u5E94\u7528",fetchOptions:Gt,setMyOption:X,style:{minWidth:"200px",maxWidth:"350px"},onChange:function(s){x(s),f.m8.push(mt(f.m8.location.pathname)+"/"+s)}}))}),Vt={tooltip:{trigger:"axis"},legend:{data:["\u6D3B\u8DC3\u8BBE\u5907\u6570","\u5E73\u5747\u6D3B\u8DC3\u65F6\u95F4"].concat((0,J.Z)(d==="current"?["\u7D2F\u8BA1\u6D3B\u8DC3\u8BBE\u5907"]:[]))},grid:{top:"30px",left:"10px",right:"10px",bottom:"50px",containLabel:!0},xAxis:[{type:"category",boundaryGap:!1,data:(r=D.data)===null||r===void 0?void 0:r.x}],yAxis:[{name:"\u8BBE\u5907\u6570",type:"value",minInterval:1},{name:"\u6D3B\u8DC3\u65F6\u95F4(\u79D2)",type:"value",max:3600}],dataZoom:[{show:!0,xAxisIndex:0,start:d==="current"?66.666:0}],series:[].concat((0,J.Z)(d==="current"?[{name:"\u7D2F\u8BA1\u6D3B\u8DC3\u8BBE\u5907",type:"custom",stack:"\u7D2F\u8BA1\u6D3B\u8DC3\u8BBE\u5907",renderItem:function(){},data:[(a=D.data)===null||a===void 0?void 0:a.total],encode:{x:0,y:0,tooltip:0},markLine:{data:[{type:"max",name:"\u672C\u65E5\u7D2F\u8BA1\u6D3B\u8DC3\u5B9E\u4F8B",label:{position:"insideStartTop",formatter:"\u672C\u65E5\u7D2F\u8BA1\u6D3B\u8DC3\u5B9E\u4F8B"},tooltip:{trigger:"item"},yAxis:(p=D.data)===null||p===void 0?void 0:p.total}]}}]:[]),[{name:"\u6D3B\u8DC3\u8BBE\u5907\u6570",type:"line",smooth:!0,stack:"\u8BBE\u5907\u6570",color:"#D23325",data:(y=D.data)===null||y===void 0?void 0:y.instance},{name:"\u5E73\u5747\u6D3B\u8DC3\u65F6\u95F4",type:"line",yAxisIndex:1,smooth:!0,color:"#5888F3",areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"#1890ff"},{offset:.5,color:"#7ec2f3"},{offset:1,color:"#ffffff"}],global:!1}},stack:"\u65F6\u95F4",data:(m=D.data)===null||m===void 0?void 0:m.time}])},Yt={tooltip:{trigger:"axis"},legend:{data:["\u6D3B\u8DC3\u5B9E\u4F8B\u6570","\u5E73\u5747\u6D3B\u8DC3\u65F6\u95F4","\u7D2F\u8BA1\u6D3B\u8DC3\u5B9E\u4F8B"]},grid:{top:"30px",left:"10px",right:"10px",bottom:"50px",containLabel:!0},xAxis:[{type:"category",boundaryGap:!1,data:(g=P.data)===null||g===void 0?void 0:g.x}],yAxis:[{name:"\u5B9E\u4F8B\u6570",type:"value",minInterval:1},{name:"\u6D3B\u8DC3\u65F6\u95F4(\u79D2)",type:"value",max:3600}],dataZoom:[{show:!0,xAxisIndex:0,start:d==="current"?66.666:0}],series:[].concat((0,J.Z)(d==="current"?[{name:"\u7D2F\u8BA1\u6D3B\u8DC3\u5B9E\u4F8B",type:"custom",stack:"\u7D2F\u8BA1\u6D3B\u8DC3\u5B9E\u4F8B",renderItem:function(){},data:[(E=P.data)===null||E===void 0?void 0:E.total],encode:{x:0,y:0,tooltip:0},markLine:{data:[{type:"max",name:"\u672C\u65E5\u7D2F\u8BA1\u6D3B\u8DC3\u5B9E\u4F8B",label:{position:"insideStartTop",formatter:"\u672C\u65E5\u7D2F\u8BA1\u6D3B\u8DC3\u5B9E\u4F8B"},tooltip:{trigger:"item"},yAxis:(C=P.data)===null||C===void 0?void 0:C.total}]}}]:[]),[{name:"\u6D3B\u8DC3\u5B9E\u4F8B\u6570",type:"line",smooth:!0,stack:"\u5B9E\u4F8B\u6570",color:"#D23325",data:(B=P.data)===null||B===void 0?void 0:B.instance},{name:"\u5E73\u5747\u6D3B\u8DC3\u65F6\u95F4",type:"line",yAxisIndex:1,smooth:!0,color:"#5888F3",areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"#1890ff"},{offset:.5,color:"#7ec2f3"},{offset:1,color:"#ffffff"}],global:!1}},stack:"\u65F6\u95F4",data:(F=P.data)===null||F===void 0?void 0:F.time}])},Ht=d==="custom"&&(h.start===0||h.end===0)?(0,t.jsx)(vt.Z,{bordered:!1,children:"\u8BF7\u9009\u62E9\u4E00\u4E2A\u65F6\u95F4\u6BB5"}):(0,t.jsxs)(v.ZP,{split:"horizontal",children:[(0,t.jsx)(v.ZP,{collapsible:!0,defaultCollapsed:!O.current.instance,title:"\u6D3B\u8DC3\u5B9E\u4F8B\u8D8B\u52BF",style:{position:"relative"},onCollapse:function(s){O.current.instance=!s,!P.data&&P.run()},children:(0,t.jsx)(at.Z,{spinning:P.loading,children:(0,t.jsx)(pt.Z,{notMerge:!0,echarts:ft.Z,option:Yt,style:{height:300}})})}),(0,t.jsx)(v.ZP,{collapsible:!0,defaultCollapsed:!O.current.device,title:"\u6D3B\u8DC3\u8BBE\u5907\u8D8B\u52BF",style:{position:"relative"},onCollapse:function(s){O.current.device=!s,!D.data&&D.run()},children:(0,t.jsx)(at.Z,{spinning:D.loading,children:(0,t.jsx)(pt.Z,{notMerge:!0,echarts:ft.Z,option:Vt,style:{height:300}})})}),(0,t.jsx)(v.ZP,{collapsible:!0,defaultCollapsed:!O.current.count,title:"\u542F\u52A8\u6B21\u6570\u8D8B\u52BF",style:{position:"relative"},bodyStyle:{height:"auto"},onCollapse:function(s){O.current.count=!s,!L.data&&L.run()},children:(0,t.jsx)(Ft.Z,{loading:L.loading||!L.data,height:300,data:L.data||[],xField:"x",yField:"y",xAxis:{visible:!0},yAxis:{visible:!0,title:{visible:!1}},slider:{start:d==="current"?.6666:0,end:1},title:{visible:!0,text:"\u542F\u52A8\u6B21\u6570\u8D8B\u52BF",style:{fontSize:14}},meta:{y:{alias:"\u542F\u52A8\u6B21\u6570"}}})})]});return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Bt.Z,{className:Tt().header,title:Qt,subTitle:"\u7684\u7EDF\u8BA1\u4FE1\u606F",extra:n&&(0,t.jsxs)(et.Z.Group,{children:[(0,t.jsx)(et.Z,{onClick:function(){f.m8.push(mt(f.m8.location.pathname,1)+"/install/"+n)},children:"\u5B89\u88C5\u7EDF\u8BA1"}),(0,t.jsx)(et.Z,{onClick:function(){f.m8.push("/app/detail/"+n)},children:"\u5E94\u7528\u8BE6\u60C5"})]}),style:{padding:0,marginBottom:20}}),n?(0,t.jsx)(dt.Z,{children:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.Suspense,{fallback:(0,t.jsx)(w.Z,{}),children:(0,t.jsx)(ct,{loading:z.loading,active:(I=z.data)===null||I===void 0?void 0:I.base})}),(0,t.jsxs)(c.Suspense,{fallback:(0,t.jsx)(w.Z,{}),children:[(0,t.jsx)(Y.Z,{offsetTop:47,style:{overflow:"hidden"},children:(0,t.jsxs)(v.ZP,{className:ut().tabs,tabs:{tabPosition:"top",size:"middle",activeKey:d,onChange:function(s){R(s)}},style:{boxShadow:"0 0 5px #00000044"},children:[(0,t.jsx)(v.ZP.TabPane,{tab:"\u8FD124\u5C0F\u65F6",cardProps:{bodyStyle:{padding:0}}},"current"),(0,t.jsx)(v.ZP.TabPane,{tab:"\u8FD1\u4E00\u4E2A\u6708",cardProps:{bodyStyle:{padding:0}}},"month"),(0,t.jsx)(v.ZP.TabPane,{tab:(0,t.jsxs)(t.Fragment,{children:["\u81EA\u5B9A\u4E49:",(0,t.jsx)(bt.Z.RangePicker,{bordered:!1,disabledDate:Xt,ranges:{\u4ECA\u65E5:[o()(),o()()],\u672C\u5468:[o()().startOf("week"),o()()],\u672C\u6708:[o()().startOf("month"),o()()],\u8FC7\u53BB7\u5929:[o()().subtract(7,"day"),o()()],\u8FC7\u53BB30\u5929:[o()().subtract(30,"day"),o()()],\u8FC7\u53BB60\u5929:[o()().subtract(60,"day"),o()()],\u8FC7\u53BB90\u5929:[o()().subtract(90,"day"),o()()],\u8FC7\u53BB120\u5929:[o()().subtract(120,"day"),o()()],\u8FC7\u53BB180\u5929:[o()().subtract(180,"day"),o()()],\u8FC7\u53BB360\u5929:[o()().subtract(360,"day"),o()()]},onCalendarChange:function(s){var G,b;return zt(s?{start:parseInt(((G=s[0])===null||G===void 0?void 0:G.startOf("day").format("X"))/3600)|0,end:parseInt(((b=s[1])===null||b===void 0?void 0:b.startOf("day").format("X"))/3600)|0}:{start:0,end:0})}})]}),cardProps:{bodyStyle:{padding:0}}},"custom")]})}),(0,t.jsx)(v.ZP,{bodyStyle:{padding:0},children:Ht})]})]})}):(0,t.jsx)(vt.Z,{bodyStyle:{textAlign:"center"},children:"\u8BF7\u5148\u9009\u62E9\u4E00\u4E2A\u5E94\u7528"})]})},Rt=Mt,Lt=e(6637);function Ut(i){return st.apply(this,arguments)}function st(){return st=(0,V.Z)(U().mark(function i(l){return U().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,Lt.y)({search:l}));case 1:case"end":return a.stop()}},i)})),st.apply(this,arguments)}var Kt=function(i){var l=i.route.name==="all-instance",r=c.useState(i.match.params.appId?i.match.params.appId:""),a=(0,A.Z)(r,2),p=a[0],y=a[1],m=c.useRef(p?"detail":"overview"),g=(0,f.tT)("admin"),E=g.selectedUser,C=g.setData,B=(0,c.useState)(E.value),F=(0,A.Z)(B,2),I=F[0],Z=F[1],M=(0,t.jsx)(Dt,{showAll:l,userId:I}),n=(0,t.jsx)(Rt,{showAll:l,userId:I,appId:p,setAppId:y}),x=c.useState(p?n:M),N=(0,A.Z)(x,2),W=N[0],d=N[1];(0,c.useEffect)(function(){R()},[I,p]);var R=function(){m.current==="overview"?d(M):d(n)};return(0,t.jsx)(_.ZP,{tabList:[{tab:"\u6982\u89C8",key:"overview"},{tab:"\u8BE6\u7EC6\u8D8B\u52BF",key:"detail"}],tabActiveKey:m.current,content:l&&(0,t.jsxs)(t.Fragment,{children:["\u5F00\u53D1\u8005\uFF1A",(0,t.jsx)(ht.Z,{showAll:!0,showSearch:!0,placeholder:"\u9009\u62E9\u7528\u6237",setMyOption:[E],fetchOptions:Ut,defaultValue:I,style:{width:"250px"},onChange:function(j,X){Z(j),C({label:X.label,value:X.value})}})]}),onTabChange:function(j){m.current=j,R()},children:W})}}}]);
